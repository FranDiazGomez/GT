/*! VisiWinJS | INOSOFT GmbH | 73.7.74.0 + 2024-06-07 */

var VisiWin,VisiWin,VisiWin,VisiWin,VisiWin;!function(t){!function(t){"use strict";t.performanceMark=function performanceMark(t,e=!0){let i=t+"_Start",o=t+"_End",r=t+"_Measure";function writeStartMark(){try{performance.mark(i)}catch(t){}}function writeMeasure(){try{performance.measure(r,i,o)}catch(t){}}return writeStartMark(),{endMark:function writeEndMark(){try{performance.mark(o),e&&writeMeasure()}catch(t){}},measure:writeMeasure,duration:function getDuration(){return performance.getEntriesByName(r,"measure")},reset:function reset(){performance&&performance.clearMarks&&(performance.clearMarks(i),performance.clearMarks(o),performance.clearMeasures(r),writeStartMark())},log:function logMeasure(){let t=performance.getEntriesByName(r,"measure");if(console)for(let e=0;e<t.length;e++)console.groupCollapsed("Performance measure for "+t[e].name),console.log("name => "+t[e].name),console.log("duration => "+t[e].duration),console.log("startTime => "+t[e].startTime),console.log("entryType => "+t[e].entryType),console.groupEnd()}}}}(t.PerformanceMark||(t.PerformanceMark={}))}(VisiWin||(VisiWin={})),function(t){!function(t){t.ErrorLog={log:console.error},t.WarnLog={log:console.warn},t.InfoLog={log:console.info},t.VerboseLog={log:null}}(t.Log||(t.Log={}))}(VisiWin||(VisiWin={})),function(t){!function(t){t.namespace="VisiWin.Resources",t.jsonUrlList=[],t.aktTheme=null,t.aktLang=null,t.styles={controls:{},controlsSource:{},stateinfo:{},stateinfoSource:{}},t.themes={},t.colors={},t.backgrounds={},t.shadows={},t.animations={},t.touchkeyboard={},t.strings={},t.media={},t.states={},t.svgBindings={},t.stateCollections={},t.samples={},t.cultureInfo={}}(t.Resources||(t.Resources={}))}(VisiWin||(VisiWin={})),function(VisiWin){var Utilities;!function(Utilities){"use strict";function isArray(t){return t instanceof Array}function loadImportJsonFile(t,e,i){let o=new XMLHttpRequest;o.onreadystatechange=function(){if(4===this.readyState)if(this.status>=200&&this.status<300)try{let i=JSON.parse(this.responseText);e(t,i)}catch(e){i(t,this.readyState,this.status),VisiWin.Log.ErrorLog.log("VisiWin.Utilities.loadJsonFile: error to parse Json file: "+t+".")}else i(t,this.readyState,this.status),VisiWin.Log.ErrorLog.log("VisiWin.Utilities.loadJsonFile: can't load file: "+t+".")},o.open("GET",t,!0),o.send()}function loadImportFile(t,e,i){let o=new XMLHttpRequest;o.onreadystatechange=function(){4===this.readyState&&(this.status>=200&&this.status<300?e(t,this.responseText):(i(t,this.readyState,this.status),VisiWin.Log.ErrorLog.log("VisiWin.Utilities.loadFile: can't load file: "+t+".")))},o.open("GET",t,!0),o.send()}function trimQuote(t){return(t=(t=(t=(t=t.trim()).replace(/^\s+|\s+$/gm,'"')).trim()).replace(/^\s+|\s+$/gm,"'")).trim()}function obj2objString(t){let e="{ ";for(let i=0;i<t.length;i++)i>0&&(e+=", "),e+=trimQuote(t[i].name)+":"+trimQuote(t[i].value);return e+" }"}function objTrimm(t){let e=t.indexOf("{"),i=t.indexOf("}");return i<0?t.substring(e+1):t.substring(e+1,i)}function objString2Obj(t){let e=objTrimm(t).split(","),i=[];for(let t=0;t<e.length;t++){let o=e[t].split(":"),r=o[0].trim(),s=o[1];i.push({name:r,value:s})}return i}function objContains(t,e){for(let i=0;i<t.length;i++)if(t[i].name===e.name)return i;return-1}function mixOptionString(t,e){let i=objString2Obj(e),o=objString2Obj(t);for(let t=0;t<i.length;t++){let e=objContains(o,i[t]);e<0?o.push(i[t]):o[e]=i[t]}return obj2objString(o)}function importCopyPropertyArray(t,e,i,o){if(void 0===t[e])t[e]=i[o];else if("object"==typeof i[o]){"object"!=typeof t[e]&&(t={});for(let r in i[o])importCopyPropertyObj(t[e],i[o],r)}else if(Array.isArray(i[o])){let r=0;Array.isArray(t[e])?r=t[e].length:t[e]=[];for(let s=0;s<i.length;s++)importCopyPropertyArray(t[e],r++,i[o],s++)}else"number"==typeof i[o]||"string"==typeof i[o]||"boolean"==typeof i[o]?t[e]=i[o]:VisiWin.Log.ErrorLog.log("VisiWin.Utilities.copyPropertyArray: unhandeld case -> typeof source:"+typeof i[o]+"  typeof target:"+typeof t[e])}function importCopyPropertyArrayFlat(t,e,i,o){if(void 0===t[e])t[e]=i[o];else if("object"==typeof i[o]){"object"!=typeof t[e]&&(t={});for(let r in i[o])importCopyPropertyObjFlat(t[e],i[o],r)}else if(Array.isArray(i[o])){let r=0;Array.isArray(t[e])?r=t[e].length:t[e]=[];for(let s=0;s<i.length;s++)importCopyPropertyArray(t[e],r++,i[o],s++)}else"number"==typeof i[o]||"string"==typeof i[o]||"boolean"==typeof i[o]?t[e]=i[o]:VisiWin.Log.ErrorLog.log("VisiWin.Utilities.copyPropertyArray: unhandeld case -> typeof source:"+typeof i[o]+"  typeof target:"+typeof t[e])}function importCopyPropertyObj(t,e,i){if(void 0===t[i])t[i]=e[i];else if("object"==typeof e[i]){"object"!=typeof t[i]&&(t={});for(let o in e[i])importCopyPropertyObj(t[i],e[i],o)}else if(Array.isArray(e[i])){let o=0;Array.isArray(t[i])?o=t[i].length:t[i]=[];for(let r=0;r<e.length;r++)importCopyPropertyArray(t[i],o++,e[i],r++)}else"number"==typeof e[i]||"string"==typeof e[i]||"boolean"==typeof e[i]?"options"!==i&&"colors"!==i||"string"!=typeof e[i]?t[i]=e[i]:t[i]=mixOptionString(t[i],e[i]):VisiWin.Log.ErrorLog.log("VisiWin.Utilities.copyPropertyObj: unhandeld case -> typeof source:"+typeof e[i]+"  typeof target:"+typeof t[i])}function importCopyPropertyObjFlat(t,e,i){if("object"==typeof e[i])for(let o in e[i])importCopyPropertyObjFlat(t,e[i],o);else if(Array.isArray(e[i])){let o=0;Array.isArray(t[i])?o=t[i].length:t[i]=[];for(let r=0;r<e.length;r++)importCopyPropertyArrayFlat(t,o++,e[i],r++)}else"number"==typeof e[i]||"string"==typeof e[i]||"boolean"==typeof e[i]?"options"!==i&&"colors"!==i||"string"!=typeof e[i]?t[i]=e[i]:t[i]=mixOptionString(t,e[i]):VisiWin.Log.ErrorLog.log("VisiWin.Utilities.copyPropertyObj: unhandeld case -> typeof source:"+typeof e[i]+"  typeof target:"+typeof t[i])}function importTranslateLoc(source,dest,infoString){let _source=source,_dest=dest,_infoString=infoString;for(let c in _source)if("string"==typeof _source[c]){let source=_source[c];if(source.indexOf('"')>0)try{source=JSON.parse(source)}catch(ex){eval("source = "+source)}else eval("source = "+source);for(let t in source){let e=source[t];0===t.indexOf("localizable")&&(VisiWin.Resources.strings[VisiWin.Resources.aktLang]&&VisiWin.Resources.strings[VisiWin.Resources.aktLang][e]?_dest[t.substr(11)]=VisiWin.Resources.strings[VisiWin.Resources.aktLang][e]:(VisiWin.Log.ErrorLog.log("VisiWin.Utilities.translateLoc: "+_infoString+": unknown textIndex:"+e),_dest[t.substr(11)]="@"+[e]))}}else"object"==typeof _source[c]&&(_dest[c]||(_dest[c]={}),VisiWin.Utilities.importTranslateLoc(_source[c],_dest[c],_infoString+"."+c))}function loadImportJsonResource(t,e,i,o,r){let s=VisiWin.Resources,n=t,l=i;if(s.jsonUrlList[n]){o({target:{href:t}})}else loadImportJsonFile(t,(function callbackReady(e,i){s.jsonUrlList[n]=n,s.jsonUrlList[n+"Type"]=[];for(let t in i)if("styles"===t){s.jsonUrlList[n+"Type"].push("styles");for(let e in i[t])if("controls"===e)for(let o in i[t][e])importCopyPropertyObj(s[t][e+"Source"],i[t][e],o),importCopyPropertyObj(s[t][e],i[t][e],o);else if("stateinfo"===e)for(let o in i[t][e])importCopyPropertyObj(s[t][e+"Source"],i[t][e],o),importCopyPropertyObj(s[t][e],i[t][e],o);else VisiWin.Log.ErrorLog.log("VisiWin.Utilities.loadJsonResource: unknown styles object "+l+': unknown "styles" item:'+t+" in resource File:"+n+".")}else if("resources"===t){s.jsonUrlList[n+"Type"].push("resources");for(let e in i[t])if("themes"===e)for(let e in i[t]){s[e]||(s[e]={});for(let o in i[t][e])importCopyPropertyObj(s[e],i[t][e],o)}else if("colors"===e)for(let o in i[t])importCopyPropertyObjFlat(s[e],i[t],o);else if("backgrounds"===e)for(let o in i[t])importCopyPropertyObjFlat(s[e],i[t],o);else if("shadows"===e)for(let o in i[t])importCopyPropertyObjFlat(s[e],i[t],o);else if("animations"===e)for(let o in i[t])importCopyPropertyObjFlat(s[e],i[t],o);else VisiWin.Log.ErrorLog.log("VisiWin.Utilities.loadJsonResource: unknown styles object "+l+': unknown "styles" item:'+t+" in resource File:"+n+".")}else if("strings"===t){s.jsonUrlList[n+"Type"].push("strings");for(let e in i[t]){s[t][e]||(s[t][e]={});for(let o in i[t][e])importCopyPropertyObj(s[t][e],i[t][e],o)}}else if("media"===t)for(let e in i[t])s[t][e]={},s[t][e].name=e,s[t][e].rule=i[t][e];else if("cultureInfo"===t)for(let e in i[t])importCopyPropertyObj(s[t],i[t],e);else if("samples"===t||"states"===t||"svgBindings"===t||"touchkeyboard"===t)for(let e in i[t])importCopyPropertyObj(s[t],i[t],e);else if("stateCollections"===t){VisiWin.Resources.stateCollections||(VisiWin.Resources.stateCollections={});let e=i[t];if(Array.isArray(e))for(let i=0;i<e.length;i++){let o=e[i].name;s[t][o]=e[i]}}else"stateLists"===t||VisiWin.Log.ErrorLog.log("VisiWin.Utilities.loadJsonResource: "+l+" unknown object: "+t+" in resource File:"+n+".");o({target:{href:t}})}),(function callbackError(t){r({target:{href:t}})}))}function loadImportJsResource(t,e,i,o,r){let s=VisiWin.Resources,n=t,l=i;if(s.jsonUrlList[n]){if("function"==typeof o){o({target:{href:t}})}}else loadImportFile(t,(function complete(e){if(s.jsonUrlList[n]=n,s.jsonUrlList[n+"Type"]=[],"function"==typeof o){o({target:{href:t}})}}),(function error(e){if(VisiWin.Log.ErrorLog.log("VisiWin.Utilities.loadJsResource "+l+": result error, can't read resource file: "+n+". Result status: "+e.status),"function"==typeof r){r({target:{href:t}})}}))}function loadImportCssTag(t,e,i){let o=document.createElement("link");return o.type="text/css",o.rel="stylesheet",o.href=t,o.media="all",o.async=!0,"function"==typeof e&&(o.onload=e),"function"==typeof i&&(o.onerror=i),document.getElementsByTagName("head")[0].appendChild(o),o}function loadImportJsTag(t,e,i){let o=document.createElement("script");return o.setAttribute("type","text/javascript"),o.setAttribute("src",t),o.async=!0,o.async=!0,"function"==typeof e&&(o.onload=e),"function"==typeof i&&(o.onerror=i),document.getElementsByTagName("head")[0].appendChild(o),o}function mixAppSettings(t,e){let i=t;if("string"==typeof e||"number"==typeof e||"boolean"==typeof e||"function"==typeof e)i=e;else if("object"==typeof e)if("object"!=typeof i||"{}"==JSON.stringify(i))i=e;else for(let t in e)i[t]?i[t]=mixAppSettings(i[t],e[t]):i[t]=e[t];else VisiWin.Log.WarnLog.log("VisiWin.Utilities: mixAppSettings unknown type for mixing: "+typeof e+". ");return i}function getObjectFromName(t,e){let i=e||window;if("string"==typeof t){let e=t.split(".");for(;e.length>1;)if(i=i[e.shift()],void 0===i)return null;return i=i[e.shift()],void 0!==i?i:null}return"function"==typeof t?t:null}function getAppSettings(t){let e=t.split(".");t.length;return getObjectFromName(t="UI"==e[0]||"Client"==e[0]||"Server"==e[0]||"System"==e[0]?"VisiWin.Application.Settings."+t:"Settings"==e[0]?"VisiWin.Application."+t:"Application"==e[0]?"VisiWin."+t:"VisiWin.Application.Settings."+t,window)}function getPathSetting(t){return getPathString(getAppSettings(t))}Utilities.isArray=isArray,Utilities.loadImportJsonFile=loadImportJsonFile,Utilities.loadImportFile=loadImportFile,Utilities.importCopyPropertyArray=importCopyPropertyArray,Utilities.importCopyPropertyArrayFlat=importCopyPropertyArrayFlat,Utilities.importCopyPropertyObj=importCopyPropertyObj,Utilities.importCopyPropertyObjFlat=importCopyPropertyObjFlat,Utilities.importTranslateLoc=importTranslateLoc,Utilities.loadImportJsonResource=loadImportJsonResource,Utilities.loadImportJsResource=loadImportJsResource,Utilities.loadImportCssTag=loadImportCssTag,Utilities.loadImportJsTag=loadImportJsTag,Utilities.mixAppSettings=mixAppSettings,Utilities.getObjectFromName=getObjectFromName,Utilities.getAppSettings=getAppSettings,Utilities.getPathSetting=getPathSetting;let runtimeVersion=null;function getPathString(t){return runtimeVersion||(runtimeVersion=getAppSettings("Server.RuntimeVersion")),("7.2"===runtimeVersion||"7.3"===runtimeVersion||"7.4"===runtimeVersion)&&"/"===t[0]?t.substr(1):t}Utilities.getPathString=getPathString}(Utilities=VisiWin.Utilities||(VisiWin.Utilities={}))}(VisiWin||(VisiWin={})),function(t){!function(t){"use strict";t.AppStartTime=new Date;class Time{constructor(t,e){this.timeStart=new Date,this.timer={},this._name=null,this._action=null,this._name=t,this._action=e}static pTime(t,e){return""}static addTime(t,e){return""}addTime(t,e){}static printTime(t,e){}pTime(t,e){if(this.tlog){if(e&&this.addTime(t,e),this.timer[t]){let e="[";for(let i=0;i<this.timer[t].action.length;i++)e+=this.timer[t].action[i]+":"+this.timer[t].time[i]+"ms, ";return e+"]"}return t+": ungültig]"}}printAllTime(){}}Time.tlog=!0,t.Time=Time}(t.Application||(t.Application={}))}(VisiWin||(VisiWin={})),function(t){!function(e){"use strict";e.modulVersion=function modulVersion(e,i,o,r){t.Application.appVersion.add(e,i,o,r)},e.modulEnd=function modulEnd(e){t.Application.appVersion.end(e)};class AppVersion{constructor(){this.modulVersionList={}}add(t,e,i,o){if(!t)return!1;let r=t.toLowerCase();return"visiwinjs.js"===r&&(AppVersion.version=e),this.modulVersionList[r]||(this.modulVersionList[r]={},this.modulVersionList[r].level=AppVersion.modulLevel++,this.modulVersionList[r].name=t,AppVersion.modulStack[AppVersion.modulStackLength++]=t,this.modulVersionList[r].version=e,this.modulVersionList[r].build=i,this.modulVersionList[r].loadBegin=null,this.modulVersionList[r].loadEnd=null,this.modulVersionList[r].executeBegin=null,this.modulVersionList[r].executeEnd=null),!0}end(t){--AppVersion.modulLevel}}AppVersion.modulStack=[],AppVersion.modulLevel=0,AppVersion.modulStackLength=0,AppVersion.version="0.0.0.0",e.AppVersion=AppVersion,e.appVersion=new t.Application.AppVersion}(t.Application||(t.Application={}))}(VisiWin||(VisiWin={})),function(t){!function(e){"use strict";e.modulImport=function modulImport(){let e=t.Utilities.getPathString("appsettings.json"),i=t.Utilities.getPathString("appsettings/appsettings.json"),o=t.Utilities.getPathString("appsettings/appsettings.services.json"),r=0,s=[],n=!1,l=!1,a=!1,p=0,g={},u=[];function onLoadImport(t){onLoad(t,!1)}function onLoadError(t){onLoad(t,!0)}function onLoad(e,i){let o=null,r=new Date;e.target.href?o=e.target.href:e.target.src?o=e.target.src:e.srcElement.href?o=e.srcElement.href:e.srcElement.src?o=e.srcElement.src:console.info(r.toLocaleTimeString()+" "+r.toLocaleDateString()+" VisiWin.apploader File: no property for filename found in onLoad or onError Event");let s=o.substr(o.lastIndexOf("/")+1);i?t.Application.Time.tlog?console.info(r.toLocaleTimeString()+" "+r.toLocaleDateString()+" VisiWin.apploader File: "+o+" can not loaded."+t.Application.Time.pTime(s,"loaded")):console.error(r.toLocaleTimeString()+" "+r.toLocaleDateString()+" VisiWin.apploader File: "+o+" can not loaded."):t.Application.Time.tlog&&(o.indexOf("http")>=0||("/"===o[0]&&(o=o.substr(1)),o="http://"+location.hostname+":"+location.port+"/"+o),console.info(r.toLocaleTimeString()+" "+r.toLocaleDateString()+" VisiWin.apploader File: "+o+" loaded. "+t.Application.Time.pTime(s,"loaded")));let n=g[s];if(n){if("function"==typeof n.onload&&n.onload(e),n.events){let t=n.events;for(let e=0;e<t.length;e++){let i=u[t[e]].require;for(let o=0;o<i.length;o++)if(n.name==i[o]){u[t[e]].require.splice(o,1);break}if(0==i.length){loadImport(u[t[e]])}}}delete g[s]}if(0===Object.keys(g).length){if(t.Utilities.getAppSettings("System.DebugLogLevel")<3){let t=new Date;console.info(t.toLocaleTimeString()+" "+t.toLocaleDateString()+" VisiWin.apploader ready.")}let e=0;t.Application.Settings.UI&&t.Utilities.isInDesignMode&&!t.Utilities.isInDesignMode()&&t.Application.Settings.UI.StartDelay&&(e="number"!=typeof t.Application.Settings.UI.StartDelay?parseInt(t.Application.Settings.UI.StartDelay,10):t.Application.Settings.UI.StartDelay),setTimeout((function(){t.Application.StartDefault?t.Application.StartDefault():t.Application.start()}),1e3*e),t.Application.Time.printTime("apploader","ready")}}function loadImport(e){if(!e.path||!e.type){let t=new Date;return e.path||console.error(t.toLocaleTimeString()+" "+t.toLocaleDateString()+" VisiWin.apploader.js: loadImport: load object: "+e.name+" without path."),void(e.type||console.error(t.toLocaleTimeString()+" "+t.toLocaleDateString()+" VisiWin.apploader.js: loadImport: load object: "+e.name+" without type."))}let i=e.path.substr(e.path.lastIndexOf("/")+1);t.Application.Time.addTime(i,"start loading");try{switch(e.type){case"js":t.Utilities.loadImportJsTag(e.path,onLoadImport,onLoadError);g[i]=e;break;case"css":t.Utilities.loadImportCssTag(e.path,onLoadImport,onLoadError);g[i]=e;break;case"svg":let o=new XMLHttpRequest;o.open("GET",e.path,!0),o.send(),o.onload=function(t){let e=document.createElement("div"),i=document.body;i?(i.insertBefore(e,i.childNodes[0]),e=i.firstElementChild,e.innerHTML=o.responseText):s[r++]=o.responseText};break;case"jsonResource":t.Utilities.loadImportJsonResource(e.path,null,"loadImportJsonResource",onLoadImport,onLoadError),g[i]=e;break;case"jsResource":t.Utilities.loadImportJsResource(e.path,null,"loadImportJsResource",onLoadImport,onLoadError),g[i]=e;break;case"htmlTemplate":t.Resources.templates||(t.Resources.templates={}),t.DataTemplateRoot||(t.DataTemplateRoot=document.createElement("DIV"));let n=document.createElement("DIV");fetch(e.path).then(t=>t.text()).then(o=>{n.innerHTML=o,t.DataTemplateRoot.appendChild(n);let r=i.split(".")[0].replace(/[\\/,.+-\s]/g,"_");t.Resources.jsonUrlList[r]={},t.Resources.jsonUrlList[r].url=e.path,t.Resources.jsonUrlList[r].type=[],t.Resources.jsonUrlList[r].type.push("htmlTemplate"),t.Resources.templates[r]||(t.Resources.templates[r]={}),t.Resources.templates[r].source=n}).catch(t=>{console.log("VisiWin.AppLoader: can't load preload HTML fragment: "+t.toString())});break;default:let l=new Date;console.error(l.toLocaleTimeString()+" "+l.toLocaleDateString()+" VisiWin.apploader.js: Can't load file from import list:"+e.name+". Unknown type.")}}catch(t){let i=new Date;console.error(i.toLocaleTimeString()+" "+i.toLocaleDateString()+" VisiWin.apploader.js: Can't load file from import list:"+e.name+". Exception "+t+".")}}function insertImport(t,e){if(!e.path||!e.type){let i=new Date;return e.path||console.error(i.toLocaleTimeString()+" "+i.toLocaleDateString()+" VisiWin.apploader.js: insertImport: import object: "+t+" without path."),void(e.type||console.error(i.toLocaleTimeString()+" "+i.toLocaleDateString()+" VisiWin.apploader.js: insertImport: import object: "+t+" without type."))}e.name=t;e.path.substr(e.path.lastIndexOf("/")+1);if(u[t]||(u[t]=e),e.require)for(let t=0;t<e.require.length;t++)if(u[e.require[t]]){let i=u[e.require[t]];i.events=i.events||[],i.events[e.name]||i.events.push(e.name)}else{let i=new Date;console.warn(i.toLocaleTimeString()+" "+i.toLocaleDateString()+" VisiWin.apploader.js: require module "+e.require[t]+" don't exists in "+e.path+" import definiton")}else loadImport(e)}function addServicesToImportList(e){let i="";let o=null;function addImportList(e,r,s,n){let l=r.replace(".","_");"/"!==r.substr(0,1)&&(r=s+"/"+r),e[l]?t.Log.ErrorLog.log("VisiWin.apploader: File: "+r+" alreday in Import list."):(e[l]={},e[l].type=function getFileType(t){let e=t.indexOf("resources"),o=t.lastIndexOf(".")+1;if(o>=0)switch(i=t.substr(o),i){case"css":i="css";break;case"js":i=e>=0?"jsResource":"js";break;case"json":i="jsonResource";break;case"html":i="htmlTemplate";break;default:i=null}else i=null;return i}(r),e[l].path=r,n?(o&&(e[l].require=[o]),o=l):o=null)}let r,s=t.PerformanceMark.performanceMark("AppLoader START");s.reset();let n=["styles.css","styles.json","mediastyles.json","localizedstyles.json"],l=null,a=t.Utilities.getPathString("resources/styles");if(a=t.Utilities.getAppSettings("UI.DirectoryNames.Styles"),l=t.Utilities.getAppSettings("UI.Styles"),l||(l=n),t.Utilities.isArray(l))for(r=0;r<l.length;r++)addImportList(e,l[r],a,!0);else addImportList(e,l,a,!0);let p=null,g=t.Utilities.getPathString("resources/themes");if(g=t.Utilities.getAppSettings("UI.DirectoryNames.Themes"),p=t.Utilities.getAppSettings("UI.Themes"),p||(p="lightTheme.json"),t.Utilities.isArray(p))for(r=0;r<p.length;r++)addImportList(e,p[r],g,!1);else addImportList(e,p,g,!1);let u=[],m=null,d=t.Utilities.getPathString("resources/statecollections");if(d=t.Utilities.getAppSettings("UI.DirectoryNames.StateCollections"),m=t.Utilities.getAppSettings("UI.StateCollections"),m||(m=u),t.Utilities.isArray(m))for(r=0;r<m.length;r++)addImportList(e,m[r],d,!1);else addImportList(e,m,d,!1);let f=[],y=null,S=t.Utilities.getPathString("resources/touchkeyboard");if(S=t.Utilities.getAppSettings("UI.DirectoryNames.TouchKeyboard"),y=t.Utilities.getAppSettings("UI.TouchKeyboard"),y||(y=f),t.Utilities.isArray(y))for(r=0;r<y.length;r++)addImportList(e,y[r],S,!1);else addImportList(e,y,S,!1);let h=t.Utilities.getPathString("resources/languageresources"),L="",U="strings",I="cultureinfo",A=["de-DE","en-US"],V=null;h=t.Utilities.getAppSettings("UI.DirectoryNames.LanguageResources"),L=t.Utilities.getAppSettings("UI.FileName.LocFilePrefix"),U=t.Utilities.getAppSettings("UI.FileName.LocStrings"),I=t.Utilities.getAppSettings("UI.FileName.LocCultureInfo"),I=t.Utilities.getAppSettings("UI.FileName.LocCultureInfo");let b=t.Utilities.getAppSettings("AppServices.LanguageService");if(b){let t=[];for(const e in b)if(b.hasOwnProperty(e))if(b[e].Name)t.push(b[e].Name);else if(b[e].length)for(var T=0;T<b[e].length;T++)b[e][T].Name&&t.push(b[e][T].Name);t.length>0&&(A=t)}else A=t.Utilities.getAppSettings("UI.Languages");if(t.Utilities.isArray(A))for(r=0;r<A.length;r++)V=L&&L.length>0?h+"/"+L+"_"+A[r]:h+"/"+A[r],U&&addImportList(e,U+"_"+A[r]+".json",V,!1);else V=L&&L.length>0?h+"/"+L+"_"+A:h+"/"+A,U&&addImportList(e,U+"_"+A+".json",V,!1);let j=["colorpalette.json","customcolors.json"],W=null,D=t.Utilities.getPathString("resources/colors");if(t.Utilities.getPathSetting("UI.DirectoryNames.Colors")&&(D=t.Utilities.getPathSetting("UI.DirectoryNames.Colors")),W=t.Utilities.getAppSettings("UI.Colors"),W||(W=j),t.Utilities.isArray(W))for(r=0;r<W.length;r++)addImportList(e,W[r],D,!1);else addImportList(e,W,D,!1);let w=["backgrounds.json"],P=null,k=t.Utilities.getPathString("resources/backgrounds");if(t.Utilities.getPathSetting("UI.DirectoryNames.Backgrounds")&&(k=t.Utilities.getPathSetting("UI.DirectoryNames.Backgrounds")),P=t.Utilities.getAppSettings("UI.Backgrounds"),P||(P=w),t.Utilities.isArray(P))for(r=0;r<P.length;r++)addImportList(e,P[r],k,!1);else addImportList(e,P,k,!1);let C=["animations.json"],E=null,F=t.Utilities.getPathString("resources/animations");if(t.Utilities.getPathSetting("UI.DirectoryNames.Animations")&&(F=t.Utilities.getPathSetting("UI.DirectoryNames.Animations")),E=t.Utilities.getAppSettings("UI.Animations"),E||(E=C),t.Utilities.isArray(E))for(r=0;r<E.length;r++)addImportList(e,E[r],F,!1);else addImportList(e,E,F,!1);let R=["shadows.json"],v=null,M=t.Utilities.getPathString("resources/shadows");if(t.Utilities.getPathSetting("UI.DirectoryNames.Shadows")&&(M=t.Utilities.getPathSetting("UI.DirectoryNames.Shadows")),v=t.Utilities.getAppSettings("UI.Shadows"),v||(v=R),t.Utilities.isArray(v))for(r=0;r<v.length;r++)addImportList(e,v[r],M,!1);else addImportList(e,v,M,!1);let O=["material-icons/material-icons.css","winjs-icons/winjs-icons.css"],N=null,J=t.Utilities.getPathString("images/iconfonts");if(t.Utilities.getPathSetting("UI.DirectoryNames.IconFonts")&&(J=t.Utilities.getPathSetting("UI.DirectoryNames.IconFonts")),N=t.Utilities.getAppSettings("UI.IconFonts"),N||(N=O),t.Utilities.isArray(N))for(r=0;r<N.length;r++)addImportList(e,N[r],J,!1);else addImportList(e,N,J,!1);let x=["systemfontstack.css","fontclasses.css"],_=null,q=t.Utilities.getPathString("resources/typography");if(t.Utilities.getPathSetting("UI.DirectoryNames.Fonts")&&(q=t.Utilities.getPathSetting("UI.DirectoryNames.Fonts")),_=t.Utilities.getAppSettings("UI.Fonts"),_||(_=x),t.Utilities.isArray(_))for(r=0;r<_.length;r++)addImportList(e,_[r],q,!1);else addImportList(e,_,q,!1);let B=[],H=null,G=t.Utilities.getPathString("Js");if(t.Utilities.getPathSetting("UI.DirectoryNames.Js")&&(G=t.Utilities.getPathSetting("UI.DirectoryNames.Js")),H=t.Utilities.getAppSettings("UI.Js"),H||(H=B),t.Utilities.isArray(H))for(r=0;r<H.length;r++)addImportList(e,H[r],G,!1);else addImportList(e,H,G,!1);let X=[],Q=null,z=t.Utilities.getPathString("Css");if(t.Utilities.getPathSetting("UI.DirectoryNames.Css")&&(z=t.Utilities.getPathSetting("UI.DirectoryNames.Css")),Q=t.Utilities.getAppSettings("UI.Css"),Q||(Q=X),t.Utilities.isArray(Q))for(r=0;r<Q.length;r++)addImportList(e,Q[r],z,!1);else addImportList(e,Q,z,!1);let K=[],$=null,Y=t.Utilities.getPathString("PreloadDataTemplates");if(t.Utilities.getPathSetting("UI.DirectoryNames.DataTemplates")&&(Y=t.Utilities.getPathSetting("UI.DirectoryNames.DataTemplates")),$=t.Utilities.getAppSettings("UI.PreloadDataTemplates"),$||($=K),t.Utilities.isArray($))for(r=0;r<$.length;r++)addImportList(e,$[r],Y,!1);else addImportList(e,$,Y,!1);s.endMark()}document.addEventListener("DOMContentLoaded",(function(){if(2==++p&&r>0)for(let t=0;t<r;t++){let e=document.createElement("div"),i=document.body;if(i)i.insertBefore(e,i.childNodes[0]),e=i.firstElementChild,e.innerHTML=s[t],r--;else{let t=new Date;console.log(t.toLocaleTimeString()+" "+t.toLocaleDateString()+" VisiWin.apploader.js: kein BodyElement in DOMContentLoaded-"+p)}}}));let m=t.PerformanceMark.performanceMark("Settings"),d=document.querySelector('meta[name="viewport"]');d&&(n=!!d.getAttribute("content"));let f,y="",S="";!function appSettingsState(r){switch(r){case 0:let r=new XMLHttpRequest;r.onreadystatechange=function(){return f=new Date,4===r.readyState&&200===r.status?(console.log(f.toLocaleTimeString()+" "+f.toLocaleDateString()+" VisiWin.apploader File: "+i+" loaded."),y=r.response,void window.setTimeout((function(){appSettingsState(1)}),0)):4===r.readyState&&404===r.status?(console.log(f.toLocaleTimeString()+" "+f.toLocaleDateString()+" VisiWin.apploader File: "+i+" can not loaded. Looking for appSetting.json in root folder."),void window.setTimeout((function(){appSettingsState(2)}),0)):void 0},r.open("GET",i,!0),r.send();break;case 1:let s=new XMLHttpRequest;s.onreadystatechange=function(){return f=new Date,4===s.readyState&&200===s.status?(console.log(f.toLocaleTimeString()+" "+f.toLocaleDateString()+" VisiWin.apploader File: "+o+" loaded."),S=s.response,void window.setTimeout((function(){appSettingsState(3)}),0)):4===s.readyState&&404===s.status?(console.log(f.toLocaleTimeString()+" "+f.toLocaleDateString()+" VisiWin.apploader File: "+o+" can not loaded."),void window.setTimeout((function(){appSettingsState(3)}),0)):void 0},s.open("GET",o,!0),s.send();break;case 2:let n=new XMLHttpRequest;n.onreadystatechange=function(){return f=new Date,4===n.readyState&&200===n.status?(console.log(f.toLocaleTimeString()+" "+f.toLocaleDateString()+" VisiWin.apploader File: "+e+" loaded."),y=n.response,void window.setTimeout((function(){appSettingsState(3)}),0)):4===n.readyState&&404===n.status?(console.log(f.toLocaleTimeString()+" "+f.toLocaleDateString()+" VisiWin.apploader File: "+e+" can not loaded."),void window.setTimeout((function(){appSettingsState(5)}),0)):void 0},n.open("GET",e,!0),n.send();break;case 3:try{t.Application.Settings=JSON.parse(y)}catch(t){console.error(f.toLocaleTimeString()+" "+f.toLocaleDateString()+" VisiWin.apploader.js: Error in JSON File "+i+".")}try{if(S){let e=JSON.parse(S);for(let i in e)t.Application.Settings[i]=e[i]}}catch(t){console.error(f.toLocaleTimeString()+" "+f.toLocaleDateString()+" VisiWin.apploader.js: Error in JSON File "+o+".")}window.setTimeout((function(){appSettingsState(4)}),0);break;case 4:if(a=function isInDebugMode(t){return!!(t&&t.UI&&t.UI.ForceDebugMode)}(t.Application.Settings),l=function isInDesignMode(e){let i=window.location.search.substring(1);t.Application.commandLine=i;let o=i.split("&");for(let t=0;t<o.length;t++){let e=o[t].split("=");if("DesignMode"==e[0]&&/true/i.test(e[1]))return!0}return!!(window.Windows&&window.Windows.ApplicationModel&&window.Windows.ApplicationModel.DesignMode&&window.Windows.ApplicationModel.DesignMode.designModeEnabled)||!!(e&&e.UI&&e.UI.ForceDesignMode)}(t.Application.Settings),u=function getImportList(e){t.Utilities.getAppSettings("System.DebugLogLevel")<3?t.Application.Time.tlog=!0:t.Application.Time.tlog=!1;let i=null;return a&&(i=t.Utilities.getAppSettings("UI.ImportList_DebugMode"))||l&&(i=t.Utilities.getAppSettings("UI.ImportList_DesignMode"))||!l&&(i=t.Utilities.getAppSettings("UI.ImportList_RunMode"))||(i=t.Utilities.getAppSettings("UI.ImportList"))?i:null}(t.Application.Settings),t.Application.Time.printTime("apploader","loading imports ready"),u){for(let e in u)u[e].path=t.Utilities.getPathString(u[e].path);addServicesToImportList(u),function insertImportList(){for(let t in u){insertImport(t,u[t])}}()}else a?console.error(f.toLocaleTimeString()+" "+f.toLocaleDateString()+' VisiWin.apploader.js: missing "importList_DebugMode" in appSettings file.'):l?console.error(f.toLocaleTimeString()+" "+f.toLocaleDateString()+' VisiWin.apploader.js: missing "importList_DesignMode" in appSettings file.'):console.error(f.toLocaleTimeString()+" "+f.toLocaleDateString()+' VisiWin.apploader.js: missing "importList_RunMode" in appSettings file.');m.endMark()}}(0),t.Application.Time.addTime("apploader","start loading settings: send")},t.Application}(t.Application||(t.Application={}))}(VisiWin||(VisiWin={})),VisiWin.Application.modulImport();